var t,e,n,i,r,s,o,a,l,c,h,p,u,d,v,m,b,f,_,g,w,y,x,C,P,k,E,V,S,M,L,A,I,D,j,T,O,R,N,U,K,B=Object.defineProperty,F=(t,e,n)=>(((t,e,n)=>{e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),z=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},H=(t,e,n)=>(z(t,e,"read from private field"),n?n.call(t):e.get(t)),q=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},$=(t,e,n,i)=>(z(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),W=(t,e,n)=>(z(t,e,"access private method"),n);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var G=function(t,e){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}G(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function X(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{l(i.next(t))}catch(e){s(e)}}function a(t){try{l(i.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}l((i=i.apply(t,e||[])).next())}))}function Q(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Z(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function tt(t,e,n){if(n||2===arguments.length)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function et(t){return this instanceof et?(this.v=t,this):new et(t)}function nt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){s.push([t,e,n,i])>1||a(t,e)}))})}function a(t,e){try{(n=r[t](e)).value instanceof et?Promise.resolve(n.value.v).then(l,c):h(s[0][2],n)}catch(i){h(s[0][3],i)}var n}function l(t){a("next",t)}function c(t){a("throw",t)}function h(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function it(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=Z(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}}function rt(t){return"function"==typeof t}var st,ot,at=(st=function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}},(ot=st((function(t){Error.call(t),t.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),ot.prototype.constructor=ot,ot);function lt(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var ct=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}var e;return t.prototype.unsubscribe=function(){var t,e,n,i,r;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var o=Z(s),a=o.next();!a.done;a=o.next()){a.value.remove(this)}}catch(d){t={error:d}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}else s.remove(this);var l=this.initialTeardown;if(rt(l))try{l()}catch(v){r=v instanceof at?v.errors:[v]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var h=Z(c),p=h.next();!p.done;p=h.next()){var u=p.value;try{pt(u)}catch(m){r=null!=r?r:[],m instanceof at?r=tt(tt([],J(r)),J(m.errors)):r.push(m)}}}catch(b){n={error:b}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}if(r)throw new at(r)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)pt(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&lt(e,t)},t.prototype.remove=function(e){var n=this._finalizers;n&&lt(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function ht(t){return t instanceof ct||t&&"closed"in t&&rt(t.remove)&&rt(t.add)&&rt(t.unsubscribe)}function pt(t){rt(t)?t():t.unsubscribe()}ct.EMPTY;var ut=void 0,dt=!1,vt={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=vt.delegate;return(null==r?void 0:r.setTimeout)?r.setTimeout.apply(r,tt([t,e],J(n))):setTimeout.apply(void 0,tt([t,e],J(n)))},clearTimeout:function(t){var e=vt.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function mt(t){vt.setTimeout((function(){throw t}))}function bt(){}var ft=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,ht(e)&&e.add(n)):n.destination=Ct,n}return Y(e,t),e.create=function(t,e,n){return new yt(t,e,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ct),_t=Function.prototype.bind;function gt(t,e){return _t.call(t,e)}var wt=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(n){xt(n)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(n){xt(n)}else xt(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){xt(e)}},t}(),yt=function(t){function e(e,n,i){var r,s,o=t.call(this)||this;rt(e)||!e?r={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=i?i:void 0}:o&&dt?((s=Object.create(e)).unsubscribe=function(){return o.unsubscribe()},r={next:e.next&&gt(e.next,s),error:e.error&&gt(e.error,s),complete:e.complete&&gt(e.complete,s)}):r=e;return o.destination=new wt(r),o}return Y(e,t),e}(ft);function xt(t){mt(t)}var Ct={closed:!0,next:bt,error:function(t){throw t},complete:bt},Pt="function"==typeof Symbol&&Symbol.observable||"@@observable";function kt(t){return t}function Et(t){return 0===t.length?kt:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var Vt=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i,r=this,s=(i=t)&&i instanceof ft||function(t){return t&&rt(t.next)&&rt(t.error)&&rt(t.complete)}(i)&&ht(i)?t:new yt(t,e,n);return function(){var t=r,e=t.operator,n=t.source;s.add(e?e.call(s,n):n?r._subscribe(s):r._trySubscribe(s))}(),s},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=St(e))((function(e,i){var r=new yt({next:function(e){try{t(e)}catch(n){i(n),r.unsubscribe()}},error:i,complete:e});n.subscribe(r)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[Pt]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Et(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=St(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function St(t){var e;return null!==(e=null!=t?t:ut)&&void 0!==e?e:Promise}function Mt(t){return function(e){if(function(t){return rt(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Lt(t,e,n,i,r){return new At(t,e,n,i,r)}var At=function(t){function e(e,n,i,r,s,o){var a=t.call(this,e)||this;return a.onFinalize=s,a.shouldUnsubscribe=o,a._next=n?function(t){try{n(t)}catch(i){e.error(i)}}:t.prototype._next,a._error=r?function(t){try{r(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return Y(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}},e}(ft),It={now:function(){return(It.delegate||Date).now()},delegate:void 0},Dt=function(t){function e(e,n){return t.call(this)||this}return Y(e,t),e.prototype.schedule=function(t,e){return this},e}(ct),jt={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=jt.delegate;return(null==r?void 0:r.setInterval)?r.setInterval.apply(r,tt([t,e],J(n))):setInterval.apply(void 0,tt([t,e],J(n)))},clearInterval:function(t){var e=jt.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},Tt=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return Y(e,t),e.prototype.schedule=function(t,e){var n;if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),jt.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&jt.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n,i=!1;try{this.work(t)}catch(r){i=!0,n=r||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),n},e.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,n=this.scheduler,i=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,lt(i,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(Dt),Ot=function(){function t(e,n){void 0===n&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(n,e)},t.now=It.now,t}(),Rt=new(function(t){function e(e,n){void 0===n&&(n=Ot.now);var i=t.call(this,e,n)||this;return i.actions=[],i._active=!1,i}return Y(e,t),e.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(Ot))(Tt),Nt=new Vt((function(t){return t.complete()}));function Ut(t){return t[t.length-1]}function Kt(t){return(e=Ut(t))&&rt(e.schedule)?t.pop():void 0;var e}function Bt(t,e){return"number"==typeof Ut(t)?t.pop():e}var Ft=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function zt(t){return rt(null==t?void 0:t.then)}function Ht(t){return rt(t[Pt])}function qt(t){return Symbol.asyncIterator&&rt(null==t?void 0:t[Symbol.asyncIterator])}function $t(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Wt="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Gt(t){return rt(null==t?void 0:t[Wt])}function Yt(t){return nt(this,arguments,(function(){var e,n,i;return Q(this,(function(r){switch(r.label){case 0:e=t.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,et(e.read())];case 3:return n=r.sent(),i=n.value,n.done?[4,et(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,et(i)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}function Xt(t){return rt(null==t?void 0:t.getReader)}function Qt(t){if(t instanceof Vt)return t;if(null!=t){if(Ht(t))return r=t,new Vt((function(t){var e=r[Pt]();if(rt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Ft(t))return i=t,new Vt((function(t){for(var e=0;e<i.length&&!t.closed;e++)t.next(i[e]);t.complete()}));if(zt(t))return n=t,new Vt((function(t){n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,mt)}));if(qt(t))return Zt(t);if(Gt(t))return e=t,new Vt((function(t){var n,i;try{for(var r=Z(e),s=r.next();!s.done;s=r.next()){var o=s.value;if(t.next(o),t.closed)return}}catch(a){n={error:a}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}t.complete()}));if(Xt(t))return Zt(Yt(t))}var e,n,i,r;throw $t(t)}function Zt(t){return new Vt((function(e){(function(t,e){var n,i,r,s;return X(this,void 0,void 0,(function(){var o,a;return Q(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=it(t),l.label=1;case 1:return[4,n.next()];case 2:if((i=l.sent()).done)return[3,4];if(o=i.value,e.next(o),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),r={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))}))})(t,e).catch((function(t){return e.error(t)}))}))}function Jt(t,e,n,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var s=e.schedule((function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()}),i);if(t.add(s),!r)return s}function te(t,e){return void 0===e&&(e=0),Mt((function(n,i){n.subscribe(Lt(i,(function(n){return Jt(i,t,(function(){return i.next(n)}),e)}),(function(){return Jt(i,t,(function(){return i.complete()}),e)}),(function(n){return Jt(i,t,(function(){return i.error(n)}),e)})))}))}function ee(t,e){return void 0===e&&(e=0),Mt((function(n,i){i.add(t.schedule((function(){return n.subscribe(i)}),e))}))}function ne(t,e){if(!t)throw new Error("Iterable cannot be null");return new Vt((function(n){Jt(n,e,(function(){var i=t[Symbol.asyncIterator]();Jt(n,e,(function(){i.next().then((function(t){t.done?n.complete():n.next(t.value)}))}),0,!0)}))}))}function ie(t,e){if(null!=t){if(Ht(t))return function(t,e){return Qt(t).pipe(ee(e),te(e))}(t,e);if(Ft(t))return function(t,e){return new Vt((function(n){var i=0;return e.schedule((function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())}))}))}(t,e);if(zt(t))return function(t,e){return Qt(t).pipe(ee(e),te(e))}(t,e);if(qt(t))return ne(t,e);if(Gt(t))return function(t,e){return new Vt((function(n){var i;return Jt(n,e,(function(){i=t[Wt](),Jt(n,e,(function(){var t,e,r;try{e=(t=i.next()).value,r=t.done}catch(s){return void n.error(s)}r?n.complete():n.next(e)}),0,!0)})),function(){return rt(null==i?void 0:i.return)&&i.return()}}))}(t,e);if(Xt(t))return function(t,e){return ne(Yt(t),e)}(t,e)}throw $t(t)}function re(t,e){return e?ie(t,e):Qt(t)}function se(t,e){return Mt((function(n,i){var r=0;n.subscribe(Lt(i,(function(n){i.next(t.call(e,n,r++))})))}))}var oe=Array.isArray;function ae(t){return se((function(e){return function(t,e){return oe(e)?t.apply(void 0,tt([],J(e))):t(e)}(t,e)}))}function le(t,e,n){return void 0===n&&(n=1/0),rt(e)?le((function(n,i){return se((function(t,r){return e(n,t,i,r)}))(Qt(t(n,i)))}),n):("number"==typeof e&&(n=e),Mt((function(e,i){return function(t,e,n,i,r,s,o,a){var l=[],c=0,h=0,p=!1,u=function(){!p||l.length||c||e.complete()},d=function(t){return c<i?v(t):l.push(t)},v=function(t){s&&e.next(t),c++;var a=!1;Qt(n(t,h++)).subscribe(Lt(e,(function(t){null==r||r(t),s?d(t):e.next(t)}),(function(){a=!0}),void 0,(function(){if(a)try{c--;for(var t=function(){var t=l.shift();o?Jt(e,o,(function(){return v(t)})):v(t)};l.length&&c<i;)t();u()}catch(n){e.error(n)}})))};return t.subscribe(Lt(e,d,(function(){p=!0,u()}))),function(){null==a||a()}}(e,i,t,n)})))}function ce(t){return void 0===t&&(t=1/0),le(kt,t)}var he=["addListener","removeListener"],pe=["addEventListener","removeEventListener"],ue=["on","off"];function de(t,e,n,i){if(rt(n)&&(i=n,n=void 0),i)return de(t,e,n).pipe(ae(i));var r=J(function(t){return rt(t.addEventListener)&&rt(t.removeEventListener)}(t)?pe.map((function(i){return function(r){return t[i](e,r,n)}})):function(t){return rt(t.addListener)&&rt(t.removeListener)}(t)?he.map(ve(t,e)):function(t){return rt(t.on)&&rt(t.off)}(t)?ue.map(ve(t,e)):[],2),s=r[0],o=r[1];if(!s&&Ft(t))return le((function(t){return de(t,e,n)}))(Qt(t));if(!s)throw new TypeError("Invalid event target");return new Vt((function(t){var e=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1<e.length?e:e[0])};return s(e),function(){return o(e)}}))}function ve(t,e){return function(n){return function(i){return t[n](e,i)}}}class me{constructor(t=0,e=0){me.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"145"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="145");class be{constructor(t,e){this.rho=0,this.p=0,this.s=new me(t,e),this.v=new me,this.f=new me}reset(t){this.f.set(0,0),this.rho=t}}class fe{constructor(t,e,n){this.grid=n,this.i=t,this.j=e,this.id=this.i+this.j*this.grid.x,this.particles=[],this.neighborIds=[],this.neighborIds.push(this.getWrapId(t+1,e));for(let i=-1;i<=1;++i)this.neighborIds.push(this.getWrapId(t+i,1+e))}getWrapId(t,e){const n=t<0?t+this.grid.x:t,i=e<0?e+this.grid.y:e;return n%this.grid.x+i%this.grid.y*this.grid.x}}class _e{constructor(){q(this,t),q(this,n),q(this,r),q(this,o),q(this,l),q(this,h),q(this,p),q(this,d),q(this,m),q(this,f),q(this,g),q(this,y),q(this,C),F(this,"particles",[])}init(n,i){this.size=i.clone(),this.count=n,this.H=1,this.HSQ=this.H*this.H;const l=Math.floor(Math.sqrt(this.size.x*this.size.y/n));this.scale=this.H/l,this.size.multiplyScalar(this.scale),this.grid=new me(Math.floor(this.size.x/this.H),Math.floor(this.size.y/this.H)),console.log(this.grid),W(this,t,e).call(this),this.REST_DENS=1.55,this.GAS_CONST=200,this.MASS=1,this.VISC=10,this.POLY6=315/(64*Math.PI*Math.pow(this.H,9)),this.SPIKY_GRAD=-45/(Math.PI*Math.pow(this.H,6)),this.VISC_LAP=45/(Math.PI*Math.pow(this.H,5)),this.BOUND_DAMPING=-.5;const c=this.grid.clone(),h=.4;c.x=Math.floor(c.x/h),c.y=Math.floor(c.y/h);const p=this.size.x-this.H*(c.x-1)*h,u=this.size.y-this.H*(c.y-1)*h;for(let t=0;t<c.x;++t)for(let e=0;e<c.y;++e){const n=new be(e*this.H*h+p/2,t*this.H*h+u/2);n.rho=this.MASS*W(this,o,a).call(this,0),this.particles.push(n),W(this,r,s).call(this,n)}this.forcePressure=new me,this.forceViscosity=new me}toSimulationSpace(t){return t.clone().multiplyScalar(this.scale)}toWorldSpace(t){return t.clone().multiplyScalar(1/this.scale)}update(t){W(this,p,u).call(this),W(this,m,b).call(this),W(this,C,P).call(this,.024)}applyExternalForce(t,e){this.externalForceCell=W(this,n,i).call(this,t),this.externalForce=e}}t=new WeakSet,e=function(){this.cells=[];for(let t=0;t<this.grid.x;t++)for(let e=0;e<this.grid.y;e++){const n=new fe(e,t,this.grid);this.cells.push(n)}},n=new WeakSet,i=function(t){let e=Math.floor(this.grid.x*(t.x/this.size.x)),n=Math.floor(this.grid.y*(t.y/this.size.y));return this.cells[e+n*this.grid.x]},r=new WeakSet,s=function(t){const e=W(this,n,i).call(this,t.s);null!=e?e.particles.push(t):console.error("Could not find cell for particle",t)},o=new WeakSet,a=function(t){let e=Math.max(0,this.HSQ-t);return this.POLY6*e*e*e},l=new WeakSet,c=function(t){let e=Math.max(0,this.H-t);return this.SPIKY_GRAD*e*e/t},h=new WeakSet,p=new WeakSet,u=function(){this.cells.forEach((t=>{t.particles.forEach(((e,n)=>{for(let i=n+1;i<t.particles.length;i++){const n=t.particles[i];W(this,d,v).call(this,e,n)}t.neighborIds.forEach((t=>{this.cells[t].particles.forEach((t=>W(this,d,v).call(this,e,t)))})),e.p=Math.max(this.GAS_CONST*(e.rho-this.REST_DENS),0)}))}))},d=new WeakSet,v=function(t,e){const n=t.s.distanceToSquared(e.s);if(n<this.HSQ){let i=this.MASS*W(this,o,a).call(this,n);t.rho+=i,e.rho+=i}},m=new WeakSet,b=function(){this.cells.forEach((t=>{t.particles.forEach(((e,n)=>{for(let i=n+1;i<t.particles.length;i++){const n=t.particles[i];W(this,f,_).call(this,e,n)}t.neighborIds.forEach((t=>{this.cells[t].particles.forEach((t=>W(this,f,_).call(this,e,t)))})),W(this,g,w).call(this,e)}))})),W(this,y,x).call(this)},f=new WeakSet,_=function(t,e){const n=e.s.clone().sub(t.s),i=n.lengthSq();if(i<this.HSQ){const r=Math.sqrt(i)+1e-9;this.forcePressure.set(0,0),this.forceViscosity.set(0,0);let s=this.MASS*((t.p+e.p)/(2*e.rho))*W(this,l,c).call(this,r);this.forcePressure.copy(n),this.forcePressure.multiplyScalar(s);const o=e.v.clone().sub(t.v);this.forceViscosity.add(o.multiplyScalar(this.VISC*this.MASS*(1/e.rho)*this.VISC_LAP*(this.H-r)));const a=this.forcePressure.clone().add(this.forceViscosity);t.f.add(a),e.f.sub(a)}},g=new WeakSet,w=function(t){this.size.x,this.size.y,this.H,this.MASS,t.p,t.rho},y=new WeakSet,x=function(){this.externalForceCell&&(this.externalForceCell.particles.forEach((t=>t.v.copy(this.externalForce))),this.externalForceCell=null)},C=new WeakSet,P=function(t){this.cells.forEach((t=>t.particles.length=0));const e=this.size.x,n=this.size.y;for(let i of this.particles){let l=i.f.clone().multiplyScalar(t*(1/i.rho));i.v.add(l),l=l.multiplyScalar(.5),i.s.add(i.v.clone().add(l).multiplyScalar(t)),i.s.x<0?(i.s.x=e-1e-6,i.v.x*=.5):i.s.x>e&&(i.s.x=1e-6,i.v.x*=.5),i.s.y<0?(i.s.y=n-1e-6,i.v.y*=.5):i.s.y>n&&(i.s.y=1e-6,i.v.y*=.5),i.rho=this.MASS*W(this,o,a).call(this,0),i.f.set(0,0),this.externalForceCell=null,W(this,r,s).call(this,i)}};k=new WeakMap,E=new WeakMap,V=new WeakMap,S=new WeakMap,M=new WeakSet,L=function(){this.viewportSize.set(this.canvas.clientWidth,this.canvas.clientHeight),this.simulationSize=new me(800,800),console.log(this.viewportSize),this.ctx=this.canvas.getContext("2d"),W(this,A,I).call(this),W(this,D,j).call(this),W(this,T,O).call(this),this.resize(),this.onInit&&this.onInit(this)},A=new WeakSet,I=function(){this.simulation.init(200,this.simulationSize)},D=new WeakSet,j=function(){var t,e;this.isPointerDown=!1,this.pointerPos=new me,this.smoothPointerPos=new me,this.prevSmoothPointerPos=new me,this.smoothPointerForce=new me,de(this.canvas,"pointerdown").subscribe((t=>{this.isPointerDown=!0,this.pointerPos.set(t.clientX,t.clientY),this.smoothPointerPos.copy(this.pointerPos),this.prevSmoothPointerPos.copy(this.pointerPos)})),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Kt(t),i=Bt(t,1/0),r=t;return r.length?1===r.length?Qt(r[0]):ce(i)(re(r,n)):Nt}(de(this.canvas,"pointerup"),de(this.canvas,"pointerleave")).subscribe((()=>this.isPointerDown=!1)),de(this.canvas,"pointermove").pipe((t=()=>this.isPointerDown,Mt((function(n,i){var r=0;n.subscribe(Lt(i,(function(n){return t.call(e,n,r++)&&i.next(n)})))})))).subscribe((t=>{this.pointerPos.set(t.clientX,t.clientY)}))},T=new WeakSet,O=function(){this.pane},R=new WeakSet,N=function(t){this.smoothPointerPos.x+=(this.pointerPos.x-this.smoothPointerPos.x)/5,this.smoothPointerPos.y+=(this.pointerPos.y-this.smoothPointerPos.y)/5,this.smoothPointerForce.copy(this.smoothPointerPos),this.smoothPointerForce.sub(this.prevSmoothPointerPos),this.prevSmoothPointerPos.copy(this.smoothPointerPos),this.smoothPointerForce.lengthSq()>1&&this.simulation.applyExternalForce(this.simulation.toSimulationSpace(this.smoothPointerPos),this.smoothPointerForce.multiplyScalar(1)),this.simulation.update(t)},U=new WeakSet,K=function(){const t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height),t.fillStyle="#bbb",this.simulation.particles.forEach((e=>{const n=this.simulation.toWorldSpace(e.s);t.beginPath(),t.ellipse(n.x,n.y,4,4,0,0,2*Math.PI),t.fill()})),t.beginPath(),t.strokeStyle="white",t.rect(0,0,this.simulationSize.x,this.simulationSize.y),t.stroke()};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var ge={exports:{}};!function(t){class e{constructor(t){const[e,n]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=null!=n?n:null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}class n{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class i{constructor(t){this.target=t}}class r extends i{constructor(t,e,n,i){super(t),this.value=e,this.presetKey=n,this.last=null==i||i}}class s extends i{constructor(t,e,n){super(t),this.value=e,this.presetKey=n}}class o extends i{constructor(t,e){super(t),this.expanded=e}}class a extends i{constructor(t,e){super(t),this.index=e}}function l(t){return t}function c(t){return null==t}function h(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}const p={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class u{constructor(t){var e;this.message=null!==(e=p[t.type](l(t.context)))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}static alreadyDisposed(){return new u({type:"alreadydisposed"})}static notBindable(){return new u({type:"notbindable"})}static propertyNotFound(t){return new u({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new u({type:"shouldneverhappen"})}}class d{constructor(t,e,n){this.obj_=t,this.key_=e,this.presetKey_=null!=n?n:e}static isBindable(t){return null!==t&&"object"==typeof t}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const n=this.read();if(!d.isBindable(n))throw u.notBindable();if(!(t in n))throw u.propertyNotFound(t);n[t]=e}}class v extends n{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.valueController.emitter.on(t,(()=>{n(new i(this))})),this}}class m{constructor(){this.observers_={}}on(t,e){let n=this.observers_[t];return n||(n=this.observers_[t]=[]),n.push({handler:e}),this}off(t,e){const n=this.observers_[t];return n&&(this.observers_[t]=n.filter((t=>t.handler!==e))),this}emit(t,e){const n=this.observers_[t];n&&n.forEach((t=>{t.handler(e)}))}}const b="tp";function f(t){return(e,n)=>[b,"-",t,"v",e?`_${e}`:"",n?`-${n}`:""].join("")}function _(t,e){return n=>e(t(n))}function g(t){return t.rawValue}function w(t,e){t.emitter.on("change",_(g,e)),e(t.rawValue)}function y(t,e,n){w(t.value(e),n)}function x(t,e,n){n?t.classList.add(e):t.classList.remove(e)}function C(t,e){return n=>{x(t,e,n)}}function P(t,e){w(t,(t=>{e.textContent=null!=t?t:""}))}const k=f("btn");class E{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(k()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("button");n.classList.add(k("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(k("t")),P(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class V{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new E(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class S{constructor(t,e){var n;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(n=null==e?void 0:e.equals)&&void 0!==n?n:(t,e)=>t===e,this.emitter=new m,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t;(!this.equals_(this.rawValue_,i)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:n,rawValue:i,sender:this}))}}class M{constructor(t){this.emitter=new m,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const n=null!=e?e:{forceEmit:!1,last:!0};(this.value_!==t||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:n,rawValue:this.value_,sender:this}))}}function L(t,e){const n=null==e?void 0:e.constraint,i=null==e?void 0:e.equals;return n||i?new S(t,e):new M(t)}class A{constructor(t){this.emitter=new m,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(t){return Object.keys(t).reduce(((e,n)=>Object.assign(e,{[n]:L(t[n])})),{})}static fromObject(t){const e=this.createCore(t);return new A(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function I(t,e){return l(Object.keys(e).reduce(((n,i)=>{if(void 0===n)return;const r=(0,e[i])(t[i]);return r.succeeded?Object.assign(Object.assign({},n),{[i]:r.value}):void 0}),{}))}function D(t,e){return t.reduce(((t,n)=>{if(void 0===t)return;const i=e(n);return i.succeeded&&void 0!==i.value?[...t,i.value]:void 0}),[])}function j(t){return null!==t&&"object"==typeof t}function T(t){return e=>n=>{if(!e&&void 0===n)return{succeeded:!1,value:void 0};if(e&&void 0===n)return{succeeded:!0,value:void 0};const i=t(n);return void 0!==i?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function O(t){return{custom:e=>T(e)(t),boolean:T((t=>"boolean"==typeof t?t:void 0))(t),number:T((t=>"number"==typeof t?t:void 0))(t),string:T((t=>"string"==typeof t?t:void 0))(t),function:T((t=>"function"==typeof t?t:void 0))(t),constant:e=>T((t=>t===e?e:void 0))(t),raw:T((t=>t))(t),object:e=>T((t=>{if(j(t))return I(t,e)}))(t),array:e=>T((t=>{if(Array.isArray(t))return D(t,e)}))(t)}}const R={optional:O(!0),required:O(!1)};function N(t,e){const n=R.required.object(e)(t);return n.succeeded?n.value:void 0}function U(t){return t&&t.parentElement&&t.parentElement.removeChild(t),null}function K(){return["veryfirst","first","last","verylast"]}const B=f(""),F={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class z{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{K().forEach((t=>{e.classList.remove(B(void 0,F[t]))})),this.blade.get("positions").forEach((t=>{e.classList.add(B(void 0,F[t]))}))})),this.viewProps.handleDispose((()=>{U(e)}))}get parent(){return this.parent_}}const H="http://www.w3.org/2000/svg";function q(t){t.offsetHeight}function $(t,e){const n=t.style.transition;t.style.transition="none",e(),t.style.transition=n}function W(t){return void 0!==t.ontouchstart}function G(){return new Function("return this")()}function Y(){return l(G()).document}function X(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d"):null}const Q={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Z(t,e){const n=t.createElementNS(H,"svg");return n.innerHTML=Q[e],n}function J(t,e,n){t.insertBefore(e,t.children[n])}function tt(t){t.parentElement&&t.parentElement.removeChild(t)}function et(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function nt(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}function it(t){return t.relatedTarget?l(t.relatedTarget):"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const rt=f("lbl");function st(t,e){const n=t.createDocumentFragment();return e.split("\n").map((e=>t.createTextNode(e))).forEach(((e,i)=>{i>0&&n.appendChild(t.createElement("br")),n.appendChild(e)})),n}class ot{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(rt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(rt("l")),y(e.props,"label",(e=>{c(e)?this.element.classList.add(rt(void 0,"nol")):(this.element.classList.remove(rt(void 0,"nol")),nt(n),n.appendChild(st(t,e)))})),this.element.appendChild(n),this.labelElement=n;const i=t.createElement("div");i.classList.add(rt("v")),this.element.appendChild(i),this.valueElement=i}}class at extends z{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new ot(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const lt={id:"button",type:"blade",accept(t){const e=R,n=N(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return n?{params:n}:null},controller:t=>new at(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:new V(t.document,{props:A.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof at&&t.controller.valueController instanceof V?new v(t.controller):null};class ct extends z{constructor(t){super(t),this.value=t.value}}function ht(){return new A({positions:L([],{equals:h})})}class pt extends A{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=A.createCore(e);return new pt(n)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const n=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};y(this,"expanded",n),y(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function ut(t,e){let n=0;return $(e,(()=>{t.set("expandedHeight",null),t.set("temporaryExpanded",!0),q(e),n=e.clientHeight,t.set("temporaryExpanded",null),q(e)})),n}function dt(t,e){e.style.height=t.styleHeight}function vt(t,e){t.value("expanded").emitter.on("beforechange",(()=>{t.set("completed",!1),c(t.get("expandedHeight"))&&t.set("expandedHeight",ut(t,e)),t.set("shouldFixHeight",!0),q(e)})),t.emitter.on("change",(()=>{dt(t,e)})),dt(t,e),e.addEventListener("transitionend",(e=>{"height"===e.propertyName&&t.cleanUpTransition()}))}class mt extends n{constructor(t,e){super(t),this.rackApi_=e}}function bt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function ft(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function _t(t,e){const n=null!=e?e:{};return t.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}function gt(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class wt{constructor(t){this.emitter=new m,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw u.shouldNeverHappen();const n=void 0!==e?e:this.items_.length;this.items_.splice(n,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach((t=>{this.cache_.add(t)}))),this.emitter.emit("add",{index:n,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const n=this.extract_(t);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class yt extends n{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new r(this,l(e),this.controller_.binding.target.presetKey,t.options.last)})}}class xt extends at{constructor(t,e){super(t,e),this.binding=e.binding}}class Ct extends n{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new m,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new s(this,l(e),this.controller_.binding.target.presetKey)})}}class Pt extends at{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function kt(t){return t instanceof St?t.apiSet_:t instanceof mt?t.rackApi_.apiSet_:null}function Et(t,e){const n=t.find((t=>t.controller_===e));if(!n)throw u.shouldNeverHappen();return n}function Vt(t,e,n){if(!d.isBindable(t))throw u.notBindable();return new d(t,e,n)}class St extends n{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new m,this.apiSet_=new wt(kt),this.pool_=e;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((t=>{this.setUpApi_(t)}))}get children(){return this.controller_.rack.children.map((t=>Et(this.apiSet_,t)))}addInput(t,e,n){const i=null!=n?n:{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createInput(r,Vt(t,e,i.presetKey),i),o=new yt(s);return this.add(o,i.index)}addMonitor(t,e,n){const i=null!=n?n:{},r=this.controller_.view.element.ownerDocument,s=this.pool_.createMonitor(r,Vt(t,e),i),o=new Ct(s);return l(this.add(o,i.index))}addFolder(t){return ft(this,t)}addButton(t){return bt(this,t)}addSeparator(t){return _t(this,t)}addTab(t){return gt(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const n=this.apiSet_.find((e=>e.controller_===t.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(e,t),i=this.pool_.createBladeApi(n);return this.add(i,t.index)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpApi_(t){this.apiSet_.find((e=>e.controller_===t))||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=Et(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof xt){const n=Et(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new r(n,l(i.target.read()),i.target.presetKey,t.options.last)})}else if(e instanceof ct){const n=Et(this.apiSet_,e);this.emitter_.emit("change",{event:new r(n,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof Pt))throw u.shouldNeverHappen();const e=Et(this.apiSet_,t.bladeController),n=t.bladeController.binding;this.emitter_.emit("update",{event:new s(e,l(n.target.read()),n.target.presetKey)})}}class Mt extends mt{constructor(t,e){super(t,new St(t.rackController,e)),this.emitter_=new m,this.controller_.foldable.value("expanded").emitter.on("change",(t=>{this.emitter_.emit("fold",{event:new o(this,t.sender.rawValue)})})),this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class Lt extends z{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class At{constructor(t,e){const n=f(e.viewName);this.element=t.createElement("div"),this.element.classList.add(n()),e.viewProps.bindClassModifiers(this.element)}}function It(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof xt&&i.binding===e)return i}return null}function Dt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof Pt&&i.binding===e)return i}return null}function jt(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(i instanceof ct&&i.value===e)return i}return null}function Tt(t){return t instanceof Nt?t.rack:t instanceof Lt?t.rackController.rack:null}function Ot(t){const e=Tt(t);return e?e.bcSet_:null}class Rt{constructor(t){var e;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new m,this.blade_=null!=t?t:null,null===(e=this.blade_)||void 0===e||e.value("positions").emitter.on("change",this.onBladePositionsChange_),this.bcSet_=new wt(Ot),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){t.parent&&t.parent.remove(t),t.parent_=this,this.bcSet_.add(t,e)}remove(t){t.parent_=null,this.bcSet_.remove(t)}find(t){return l(this.bcSet_.allItems().filter((e=>e instanceof t)))}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const n=t.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof xt)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof Pt)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof ct)n.value.emitter.on("change",this.onChildValueChange_);else{const t=Tt(n);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const n=t.item;if(n instanceof xt)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof Pt)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof ct)n.value.emitter.off("change",this.onChildValueChange_);else{const t=Tt(n);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter((t=>!t.viewProps.get("hidden"))),e=t[0],n=t[t.length-1];this.bcSet_.items.forEach((t=>{const i=[];t===e&&(i.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||i.push("veryfirst")),t===n&&(i.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||i.push("verylast")),t.blade.set("positions",i)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((t=>t.viewProps.get("disposed"))).forEach((t=>{this.bcSet_.remove(t)}))}onChildInputChange_(t){const e=It(this.find(xt),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=Dt(this.find(Pt),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=jt(this.find(ct),t.sender);if(!e)throw u.shouldNeverHappen();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Nt extends z{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new At(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new Rt(e.root?void 0:e.blade);n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)}))}onRackAdd_(t){t.isRoot&&J(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&tt(t.bladeController.view.element)}}const Ut=f("cnt");class Kt{constructor(t,e){var n;this.className_=f(null!==(n=e.viewName)&&void 0!==n?n:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Ut()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),y(this.foldable_,"completed",C(this.element,this.className_(void 0,"cpl")));const i=t.createElement("button");i.classList.add(this.className_("b")),y(e.props,"title",(t=>{c(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const r=t.createElement("div");r.classList.add(this.className_("t")),P(e.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r;const s=t.createElement("div");s.classList.add(this.className_("m")),this.buttonElement.appendChild(s);const o=e.containerElement;o.classList.add(this.className_("c")),this.element.appendChild(o),this.containerElement=o}}class Bt extends Lt{constructor(t,e){var n;const i=pt.create(null===(n=e.expanded)||void 0===n||n),r=new Nt(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:r,view:new Kt(t,{containerElement:r.view.element,foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,vt(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Ft={id:"folder",type:"blade",accept(t){const e=R,n=N(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return n?{params:n}:null},controller:t=>new Bt(t.document,{blade:t.blade,expanded:t.params.expanded,props:A.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof Bt?new Mt(t.controller,t.pool):null};class zt extends ct{constructor(t,e){const n=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new ot(t,{props:e.props,viewProps:n}),viewProps:n})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Ht extends n{}const qt=f("spr");class $t{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(qt()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("hr");n.classList.add(qt("r")),this.element.appendChild(n)}}class Wt extends z{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new $t(t,{viewProps:e.viewProps})}))}}const Gt={id:"separator",type:"blade",accept(t){const e=N(t,{view:R.required.constant("separator")});return e?{params:e}:null},controller:t=>new Wt(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof Wt?new Ht(t.controller):null},Yt=f("");function Xt(t,e){return C(t,Yt(void 0,e))}class Qt extends A{constructor(t){super(t)}static create(t){var e,n;const i=null!=t?t:{},r={disabled:null!==(e=i.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(n=i.hidden)&&void 0!==n&&n},s=A.createCore(r);return new Qt(s)}bindClassModifiers(t){y(this,"disabled",Xt(t,"disabled")),y(this,"hidden",Xt(t,"hidden"))}bindDisabled(t){y(this,"disabled",(e=>{t.disabled=e}))}bindTabIndex(t){y(this,"disabled",(e=>{t.tabIndex=e?-1:0}))}handleDispose(t){this.value("disposed").emitter.on("change",(e=>{e&&t()}))}}const Zt=f("tbi");class Jt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Zt()),e.viewProps.bindClassModifiers(this.element),y(e.props,"selected",(t=>{t?this.element.classList.add(Zt(void 0,"sel")):this.element.classList.remove(Zt(void 0,"sel"))}));const n=t.createElement("button");n.classList.add(Zt("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(Zt("t")),P(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class te{constructor(t,e){this.emitter=new m,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Jt(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class ee{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new te(t,{props:e.itemProps,viewProps:Qt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new Nt(t,{blade:ht(),viewProps:Qt.create()}),this.props=e.props,y(this.props,"selected",(t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class ne{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,n){return this.rackApi_.addInput(t,e,n)}addMonitor(t,e,n){return this.rackApi_.addMonitor(t,e,n)}addBlade(t){return this.rackApi_.addBlade(t)}}class ie extends mt{constructor(t,e){super(t,new St(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new m,this.pageApiMap_=new Map,this.rackApi_.on("change",(t=>{this.emitter_.emit("change",{event:t})})),this.rackApi_.on("update",(t=>{this.emitter_.emit("update",{event:t})})),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((t=>{this.setUpPageApi_(t)}))}get pages(){return this.controller_.pageSet.items.map((t=>{const e=this.pageApiMap_.get(t);if(!e)throw u.shouldNeverHappen();return e}))}addPage(t){const e=this.controller_.view.element.ownerDocument,n=new ee(e,{itemProps:A.fromObject({selected:!1,title:t.title}),props:A.fromObject({selected:!1})});this.controller_.add(n,t.index);const i=this.pageApiMap_.get(n);if(!i)throw u.shouldNeverHappen();return i}removePage(t){this.controller_.remove(t)}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find((e=>e.controller_===t.contentController));if(!e)throw u.shouldNeverHappen();const n=new ne(t,e);this.pageApiMap_.set(t,n)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw u.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new a(this,t.rawValue)})}}const re=-1;class se{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=L(!0),this.selectedIndex=L(re),this.items_=[]}add(t,e){const n=null!=e?e:this.items_.length;this.items_.splice(n,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=re,void(this.empty.rawValue=!0);const t=this.items_.findIndex((t=>t.rawValue));t<0?(this.items_.forEach(((t,e)=>{t.rawValue=0===e})),this.selectedIndex.rawValue=0):(this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex((e=>e===t.sender));this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const oe=f("tab");class ae{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(oe(),Ut()),e.viewProps.bindClassModifiers(this.element),w(e.empty,C(this.element,oe(void 0,"nop")));const n=t.createElement("div");n.classList.add(oe("i")),this.element.appendChild(n),this.itemsElement=n;const i=e.contentsElement;i.classList.add(oe("c")),this.element.appendChild(i),this.contentsElement=i}}class le extends Lt{constructor(t,e){const n=new Nt(t,{blade:e.blade,viewProps:e.viewProps}),i=new se;super({blade:e.blade,rackController:n,view:new ae(t,{contentsElement:n.view.element,empty:i.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new wt((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=i}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;J(this.view.itemsElement,e.itemController.view.element,t.index),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;tt(e.itemController.view.element),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const ce={id:"tab",type:"blade",accept(t){const e=R,n=N(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(t){const e=new le(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach((n=>{const i=new ee(t.document,{itemProps:A.fromObject({selected:!1,title:n.title}),props:A.fromObject({selected:!1})});e.add(i)})),e},api:t=>t.controller instanceof le?new ie(t.controller,t.pool):null};function he(t,e){const n=t.accept(e.params);if(!n)return null;const i=R.optional.boolean(e.params.disabled).value,r=R.optional.boolean(e.params.hidden).value;return t.controller({blade:ht(),document:e.document,params:l(Object.assign(Object.assign({},n.params),{disabled:i,hidden:r})),viewProps:Qt.create({disabled:i,hidden:r})})}class pe{constructor(){this.disabled=!1,this.emitter=new m}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class ue{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new m,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class de{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce(((t,e)=>e.constrain(t)),t)}}function ve(t,e){if(t instanceof e)return t;if(t instanceof de){const n=t.constraints.reduce(((t,n)=>t||(n instanceof e?n:null)),null);if(n)return n}return null}class me{constructor(t){this.options=t}constrain(t){const e=this.options;return 0===e.length||e.filter((e=>e.value===t)).length>0?t:e[0].value}}class be{constructor(t){this.maxValue=t.max,this.minValue=t.min}constrain(t){let e=t;return c(this.minValue)||(e=Math.max(e,this.minValue)),c(this.maxValue)||(e=Math.min(e,this.maxValue)),e}}class fe{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const _e=f("lst");class ge{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(_e()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("select");n.classList.add(_e("s")),y(this.props_,"options",(e=>{et(n),e.forEach(((e,i)=>{const r=t.createElement("option");r.dataset.index=String(i),r.textContent=e.text,r.value=String(e.value),n.appendChild(r)}))})),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const i=t.createElement("div");i.classList.add(_e("m")),i.appendChild(Z(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class we{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ge(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=l(t.currentTarget).selectedOptions.item(0);if(!e)return;const n=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[n].value}}const ye=f("pop");class xe{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ye()),e.viewProps.bindClassModifiers(this.element),w(e.shows,C(this.element,ye(void 0,"v")))}}class Ce{constructor(t,e){this.shows=L(!1),this.viewProps=e.viewProps,this.view=new xe(t,{shows:this.shows,viewProps:this.viewProps})}}const Pe=f("txt");class ke{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Pe()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const n=t.createElement("input");n.classList.add(Pe("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Ee{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ke(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=l(t.currentTarget).value,n=this.parser_(e);c(n)||(this.value.rawValue=n),this.view.refresh()}}function Ve(t){return String(t)}function Se(t){return"false"!==t&&!!t}function Me(t){return Ve(t)}class Le{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const Ae={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class Ie{constructor(t,e,n){this.left=e,this.operator=t,this.right=n}evaluate(){const t=Ae[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const De={"+":t=>t,"-":t=>-t,"~":t=>~t};class je{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=De[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Te(t){return(e,n)=>{for(let i=0;i<t.length;i++){const r=t[i](e,n);if(""!==r)return r}return""}}function Oe(t,e){var n;const i=t.substr(e).match(/^\s+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Re(t,e){const n=t.substr(e,1);return n.match(/^[1-9]$/)?n:""}function Ne(t,e){var n;const i=t.substr(e).match(/^[0-9]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ue(t,e){const n=Ne(t,e);if(""!==n)return n;const i=t.substr(e,1);if("-"!==i&&"+"!==i)return"";const r=Ne(t,e+=1);return""===r?"":i+r}function Ke(t,e){const n=t.substr(e,1);if(e+=1,"e"!==n.toLowerCase())return"";const i=Ue(t,e);return""===i?"":n+i}function Be(t,e){const n=t.substr(e,1);if("0"===n)return n;const i=Re(t,e);return e+=i.length,""===i?"":i+Ne(t,e)}function Fe(t,e){const n=Be(t,e);if(e+=n.length,""===n)return"";const i=t.substr(e,1);if(e+=i.length,"."!==i)return"";const r=Ne(t,e);return n+i+r+Ke(t,e+=r.length)}function ze(t,e){const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=Ne(t,e);return e+=i.length,""===i?"":n+i+Ke(t,e)}function He(t,e){const n=Be(t,e);return e+=n.length,""===n?"":n+Ke(t,e)}const qe=Te([Fe,ze,He]);function $e(t,e){var n;const i=t.substr(e).match(/^[01]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function We(t,e){const n=t.substr(e,2);if(e+=n.length,"0b"!==n.toLowerCase())return"";const i=$e(t,e);return""===i?"":n+i}function Ge(t,e){var n;const i=t.substr(e).match(/^[0-7]+/);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Ye(t,e){const n=t.substr(e,2);if(e+=n.length,"0o"!==n.toLowerCase())return"";const i=Ge(t,e);return""===i?"":n+i}function Xe(t,e){var n;const i=t.substr(e).match(/^[0-9a-f]+/i);return null!==(n=i&&i[0])&&void 0!==n?n:""}function Qe(t,e){const n=t.substr(e,2);if(e+=n.length,"0x"!==n.toLowerCase())return"";const i=Xe(t,e);return""===i?"":n+i}const Ze=Te([We,Ye,Qe]),Je=Te([Ze,qe]);function tn(t,e){const n=Je(t,e);return e+=n.length,""===n?null:{evaluable:new Le(n),cursor:e}}function en(t,e){const n=t.substr(e,1);if(e+=n.length,"("!==n)return null;const i=ln(t,e);if(!i)return null;e=i.cursor,e+=Oe(t,e).length;const r=t.substr(e,1);return e+=r.length,")"!==r?null:{evaluable:i.evaluable,cursor:e}}function nn(t,e){var n;return null!==(n=tn(t,e))&&void 0!==n?n:en(t,e)}function rn(t,e){const n=nn(t,e);if(n)return n;const i=t.substr(e,1);if(e+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const r=rn(t,e);return r?{cursor:e=r.cursor,evaluable:new je(i,r.evaluable)}:null}function sn(t,e,n){n+=Oe(e,n).length;const i=t.filter((t=>e.startsWith(t,n)))[0];return i?(n+=i.length,{cursor:n+=Oe(e,n).length,operator:i}):null}function on(t,e){return(n,i)=>{const r=t(n,i);if(!r)return null;i=r.cursor;let s=r.evaluable;for(;;){const r=sn(e,n,i);if(!r)break;i=r.cursor;const o=t(n,i);if(!o)return null;i=o.cursor,s=new Ie(r.operator,s,o.evaluable)}return s?{cursor:i,evaluable:s}:null}}const an=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((t,e)=>on(t,e)),rn);function ln(t,e){return e+=Oe(t,e).length,an(t,e)}function cn(t){const e=ln(t,0);return e?e.cursor+Oe(t,e.cursor).length!==t.length?null:e.evaluable:null}function hn(t){var e;const n=cn(t);return null!==(e=null==n?void 0:n.evaluate())&&void 0!==e?e:null}function pn(t){if("number"==typeof t)return t;if("string"==typeof t){const e=hn(t);if(!c(e))return e}return 0}function un(t){return String(t)}function dn(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const vn=dn(0);function mn(t){return vn(t)+"%"}function bn(t){return String(t)}function fn(t){return t}function _n(t,e){for(;t.length<e;)t.push(void 0)}function gn(t){const e=[];return _n(e,t),L(e)}function wn(t){const e=t.indexOf(void 0);return l(e<0?t:t.slice(0,e))}function yn(t,e){const n=[...wn(t),e];return n.length>t.length?n.splice(0,n.length-t.length):_n(n,t.length),n}function xn({primary:t,secondary:e,forward:n,backward:i}){let r=!1;function s(t){r||(r=!0,t(),r=!1)}t.emitter.on("change",(i=>{s((()=>{e.setRawValue(n(t,e),i.options)}))})),e.emitter.on("change",(r=>{s((()=>{t.setRawValue(i(t,e),r.options)})),s((()=>{e.setRawValue(n(t,e),r.options)}))})),s((()=>{e.setRawValue(n(t,e),{forceEmit:!1,last:!0})}))}function Cn(t,e){const n=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+n:e.downKey?-n:0}function Pn(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function kn(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function En(t){return"ArrowUp"===t||"ArrowDown"===t}function Vn(t){return En(t)||"ArrowLeft"===t||"ArrowRight"===t}function Sn(t,e){var n,i;const r=e.ownerDocument.defaultView,s=e.getBoundingClientRect();return{x:t.pageX-((null!==(n=r&&r.scrollX)&&void 0!==n?n:0)+s.left),y:t.pageY-((null!==(i=r&&r.scrollY)&&void 0!==i?i:0)+s.top)}}class Mn{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new m,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Sn(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-n.left,y:e.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const n=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(n?{x:n.clientX-i.left,y:n.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function Ln(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}function An(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function In(t,e,n){return Math.min(Math.max(t,e),n)}function Dn(t,e){return(t%e+e)%e}const jn=f("txt");class Tn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(jn(),jn(void 0,"num")),e.arrayPosition&&this.element.classList.add(jn(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(jn("i")),n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(jn()),this.inputElement.classList.add(jn("i"));const i=t.createElement("div");i.classList.add(jn("k")),this.element.appendChild(i),this.knobElement=i;const r=t.createElementNS(H,"svg");r.classList.add(jn("g")),this.knobElement.appendChild(r);const s=t.createElementNS(H,"path");s.classList.add(jn("gb")),r.appendChild(s),this.guideBodyElem_=s;const o=t.createElementNS(H,"path");o.classList.add(jn("gh")),r.appendChild(o),this.guideHeadElem_=o;const a=t.createElement("div");a.classList.add(f("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(jn(void 0,"drg"));this.element.classList.add(jn(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),n=e+(e>0?-1:e<0?1:0),i=In(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+i},0 L${n},4 L${n+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class On{constructor(t,e){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(n=e.sliderProps)&&void 0!==n?n:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=L(null),this.view=new Tn(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Mn(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,n;const i=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),r=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("maxValue");let s=t;return void 0!==i&&(s=Math.max(s,i)),void 0!==r&&(s=Math.min(s,r)),s}onInputChange_(t){const e=l(t.currentTarget).value,n=this.parser_(e);c(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(t){const e=Cn(this.baseStep_,Pn(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==Cn(this.baseStep_,Pn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Rn=f("sld");class Nn{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Rn()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Rn("t")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const i=t.createElement("div");i.classList.add(Rn("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=In(Ln(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Un{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Nn(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mn(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(Ln(In(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Cn(this.baseStep_,kn(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Cn(this.baseStep_,kn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Kn=f("sldtxt");class Bn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Kn());const n=t.createElement("div");n.classList.add(Kn("s")),this.sliderView_=e.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(Kn("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class Fn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Un(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new On(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new Bn(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function zn(t,e){t.write(e)}function Hn(t){const e=R;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function qn(t){if("inline"===t||"popup"===t)return t}function $n(t){const e=R;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function Wn(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach((n=>{e.push({text:n,value:t[n]})})),e}function Gn(t){return c(t)?null:new me(Wn(l(t)))}function Yn(t){const e=t?ve(t,me):null;return e?e.options:null}function Xn(t){const e=t?ve(t,fe):null;return e?e.step:null}function Qn(t,e){const n=t&&ve(t,fe);return n?An(n.step):Math.max(An(e),2)}function Zn(t){const e=Xn(t);return null!=e?e:1}function Jn(t,e){var n;const i=t&&ve(t,fe),r=Math.abs(null!==(n=null==i?void 0:i.step)&&void 0!==n?n:e);return 0===r?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}const ti=f("ckb");class ei{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ti()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("label");n.classList.add(ti("l")),this.element.appendChild(n);const i=t.createElement("input");i.classList.add(ti("i")),i.type="checkbox",n.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const r=t.createElement("div");r.classList.add(ti("w")),n.appendChild(r);const s=Z(t,"check");r.appendChild(s),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class ni{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new ei(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=l(t.currentTarget);this.value.rawValue=e.checked}}function ii(t){const e=[],n=Gn(t.options);return n&&e.push(n),new de(e)}const ri={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=N(e,{options:R.optional.custom(Hn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Se,constraint:t=>ii(t.params),writer:t=>zn},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&ve(r,me)?new we(n,{props:A.fromObject({options:null!==(e=Yn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new ni(n,{value:i,viewProps:t.viewProps})}},si=f("col");class oi{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(si()),e.foldable.bindExpandedClass(this.element,si(void 0,"expanded")),y(e.foldable,"completed",C(this.element,si(void 0,"cpl")));const n=t.createElement("div");n.classList.add(si("h")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(si("s")),n.appendChild(i),this.swatchElement=i;const r=t.createElement("div");if(r.classList.add(si("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(si("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function ai(t,e,n){const i=In(t/255,0,1),r=In(e/255,0,1),s=In(n/255,0,1),o=Math.max(i,r,s),a=Math.min(i,r,s),l=o-a;let c=0,h=0;const p=(a+o)/2;return 0!==l&&(h=l/(1-Math.abs(o+a-1)),c=i===o?(r-s)/l:r===o?2+(s-i)/l:4+(i-r)/l,c=c/6+(c<0?1:0)),[360*c,100*h,100*p]}function li(t,e,n){const i=(t%360+360)%360,r=In(e/100,0,1),s=In(n/100,0,1),o=(1-Math.abs(2*s-1))*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o/2;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}function ci(t,e,n){const i=In(t/255,0,1),r=In(e/255,0,1),s=In(n/255,0,1),o=Math.max(i,r,s),a=o-Math.min(i,r,s);let l;return l=0===a?0:o===i?((r-s)/a%6+6)%6*60:o===r?60*((s-i)/a+2):60*((i-r)/a+4),[l,100*(0===o?0:a/o),100*o]}function hi(t,e,n){const i=Dn(t,360),r=In(e/100,0,1),s=In(n/100,0,1),o=s*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o;let c,h,p;return[c,h,p]=i>=0&&i<60?[o,a,0]:i>=60&&i<120?[a,o,0]:i>=120&&i<180?[0,o,a]:i>=180&&i<240?[0,a,o]:i>=240&&i<300?[a,0,o]:[o,0,a],[255*(c+l),255*(h+l),255*(p+l)]}function pi(t,e,n){const i=n+e*(100-Math.abs(2*n-100))/200;return[t,0!==i?e*(100-Math.abs(2*n-100))/i:0,n+e*(100-Math.abs(2*n-100))/200]}function ui(t,e,n){const i=100-Math.abs(n*(200-e)/100-100);return[t,0!==i?e*n/i:0,n*(200-e)/200]}function di(t){return[t[0],t[1],t[2]]}function vi(t,e){return[t[0],t[1],t[2],e]}const mi={hsl:{hsl:(t,e,n)=>[t,e,n],hsv:pi,rgb:li},hsv:{hsl:ui,hsv:(t,e,n)=>[t,e,n],rgb:hi},rgb:{hsl:ai,hsv:ci,rgb:(t,e,n)=>[t,e,n]}};function bi(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function fi(t,e,n){var i;const r=bi(e,n);return["rgb"===e?In(t[0],0,r[0]):Dn(t[0],r[0]),In(t[1],0,r[1]),In(t[2],0,r[2]),In(null!==(i=t[3])&&void 0!==i?i:1,0,1)]}function _i(t,e,n,i){const r=bi(e,n),s=bi(e,i);return t.map(((t,e)=>t/r[e]*s[e]))}function gi(t,e,n){const i=_i(t,e.mode,e.type,"int");return _i(mi[e.mode][n.mode](...i),n.mode,"int",n.type)}function wi(t,e){return"object"==typeof t&&!c(t)&&e in t&&"number"==typeof t[e]}class yi{constructor(t,e,n="int"){this.mode=e,this.type=n,this.comps_=fi(t,e,n)}static black(t="int"){return new yi([0,0,0],"rgb",t)}static fromObject(t,e="int"){const n="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new yi(n,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return wi(t,"r")&&wi(t,"g")&&wi(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&wi(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const n=t.comps_,i=e.comps_;for(let r=0;r<n.length;r++)if(n[r]!==i[r])return!1;return!0}getComponents(t,e="int"){return vi(gi(di(this.comps_),{mode:this.mode,type:this.type},{mode:null!=t?t:this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const xi=f("colp");class Ci{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(xi());const n=t.createElement("div");n.classList.add(xi("hsv"));const i=t.createElement("div");i.classList.add(xi("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(xi("h")),this.hPaletteView_=e.hPaletteView,r.appendChild(this.hPaletteView_.element),n.appendChild(r),this.element.appendChild(n);const s=t.createElement("div");if(s.classList.add(xi("rgb")),this.textView_=e.textView,s.appendChild(this.textView_.element),this.element.appendChild(s),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const n=t.createElement("div");n.classList.add(xi("a"));const i=t.createElement("div");i.classList.add(xi("ap")),i.appendChild(this.alphaViews_.palette.element),n.appendChild(i);const r=t.createElement("div");r.classList.add(xi("at")),r.appendChild(this.alphaViews_.text.element),n.appendChild(r),this.element.appendChild(n)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((t=>t.inputElement))];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Pi(t){return"int"===t?"int":"float"===t?"float":void 0}function ki(t){const e=R;return N(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Pi)}),expanded:e.optional.boolean,picker:e.optional.custom(qn)})}function Ei(t){return t?.1:1}function Vi(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function Si(t,e){return t.alpha===e.alpha&&t.mode===e.mode&&t.notation===e.notation&&t.type===e.type}function Mi(t,e){const n=t.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*e,e):Math.min(parseFloat(t),e)}const Li={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Ai(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const n=parseFloat(e[1]),i=e[2];return Li[i](n)}function Ii(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mi(e[1],255),Mi(e[2],255),Mi(e[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Di(t){return e=>{const n=Ii(e);return n?new yi(n,"rgb",t):null}}function ji(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Mi(e[1],255),Mi(e[2],255),Mi(e[3],255),Mi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Ti(t){return e=>{const n=ji(e);return n?new yi(n,"rgb",t):null}}function Oi(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Ai(e[1]),Mi(e[2],100),Mi(e[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Ri(t){return e=>{const n=Oi(e);return n?new yi(n,"hsl",t):null}}function Ni(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const n=[Ai(e[1]),Mi(e[2],100),Mi(e[3],100),Mi(e[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Ui(t){return e=>{const n=Ni(e);return n?new yi(n,"hsl",t):null}}function Ki(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const n=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Bi(t){const e=Ki(t);return e?new yi(e,"rgb","int"):null}function Fi(t){const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Ln(parseInt(e[4]+e[4],16),0,255,0,1)];const n=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),Ln(parseInt(n[4],16),0,255,0,1)]:null}function zi(t){const e=Fi(t);return e?new yi(e,"rgb","int"):null}function Hi(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function qi(t){return e=>{const n=Hi(e);return n?new yi(n,"rgb",t):null}}function $i(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const n=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Wi(t){return e=>{const n=$i(e);return n?new yi(n,"rgb",t):null}}const Gi=[{parser:Ki,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Fi,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ii,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:ji,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Oi,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Ni,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Hi,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:$i,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Yi(t){return Gi.reduce(((e,{parser:n,result:i})=>e||(n(t)?i:null)),null)}function Xi(t,e="int"){const n=Yi(t);return n?"hex"===n.notation&&"float"!==e?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:e}):null:null}const Qi={int:[Bi,zi,Di("int"),Ti("int"),Ri("int"),Ui("int"),qi("int"),Wi("int")],float:[Di("float"),Ti("float"),Ri("float"),Ui("float"),qi("float"),Wi("float")]};function Zi(t){const e=Qi[t];return n=>{if("string"!=typeof n)return yi.black(t);const i=e.reduce(((t,e)=>t||e(n)),null);return null!=i?i:yi.black(t)}}function Ji(t){const e=Qi[t];return t=>e.reduce(((e,n)=>e||n(t)),null)}function tr(t){const e=In(Math.floor(t),0,255).toString(16);return 1===e.length?`0${e}`:e}function er(t,e="#"){return`${e}${di(t.getComponents("rgb")).map(tr).join("")}`}function nr(t,e="#"){const n=t.getComponents("rgb");return`${e}${[n[0],n[1],n[2],255*n[3]].map(tr).join("")}`}function ir(t,e){const n=dn("float"===e?2:0);return`rgb(${di(t.getComponents("rgb",e)).map((t=>n(t))).join(", ")})`}function rr(t){return e=>ir(e,t)}function sr(t,e){const n=dn(2),i=dn("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map(((t,e)=>(3===e?n:i)(t))).join(", ")})`}function or(t){return e=>sr(e,t)}function ar(t){const e=[dn(0),mn,mn];return`hsl(${di(t.getComponents("hsl")).map(((t,n)=>e[n](t))).join(", ")})`}function lr(t){const e=[dn(0),mn,mn,dn(2)];return`hsla(${t.getComponents("hsl").map(((t,n)=>e[n](t))).join(", ")})`}function cr(t,e){const n=dn("float"===e?2:0),i=["r","g","b"];return`{${di(t.getComponents("rgb",e)).map(((t,e)=>`${i[e]}: ${n(t)}`)).join(", ")}}`}function hr(t){return e=>cr(e,t)}function pr(t,e){const n=dn(2),i=dn("float"===e?2:0),r=["r","g","b","a"];return`{${t.getComponents("rgb",e).map(((t,e)=>{const s=3===e?n:i;return`${r[e]}: ${s(t)}`})).join(", ")}}`}function ur(t){return e=>pr(e,t)}const dr=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:er},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:nr},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:ar},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:lr},...["int","float"].reduce(((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:rr(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:or(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:hr(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:ur(e)}]),[])];function vr(t){return dr.reduce(((e,n)=>e||(Si(n.format,t)?n.stringifier:null)),null)}const mr=f("apl");class br{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(mr()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(mr("b")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(mr("c")),n.appendChild(i),this.colorElem_=i;const r=t.createElement("div");r.classList.add(mr("m")),this.element.appendChild(r),this.markerElem_=r;const s=t.createElement("div");s.classList.add(mr("p")),this.markerElem_.appendChild(s),this.previewElem_=s,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),n=new yi([e[0],e[1],e[2],0],"rgb"),i=new yi([e[0],e[1],e[2],255],"rgb"),r=["to right",sr(n),sr(i)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=sr(t);const s=Ln(e[3],0,1,0,100);this.markerElem_.style.left=`${s}%`}onValueChange_(){this.update_()}}class fr{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new br(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=t.point.x/t.bounds.width,i=this.value.rawValue,[r,s,o]=i.getComponents("hsv");this.value.setRawValue(new yi([r,s,o,n],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Cn(Ei(!0),kn(t));if(0===e)return;const n=this.value.rawValue,[i,r,s,o]=n.getComponents("hsv");this.value.setRawValue(new yi([i,r,s,o+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Cn(Ei(!0),kn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const _r=f("coltxt");function gr(t){const e=t.createElement("select"),n=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(n.reduce(((e,n)=>{const i=t.createElement("option");return i.textContent=n.text,i.value=n.value,e.appendChild(i),e}),t.createDocumentFragment())),e}class wr{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_r());const n=t.createElement("div");n.classList.add(_r("m")),this.modeElem_=gr(t),this.modeElem_.classList.add(_r("ms")),n.appendChild(this.modeSelectElement);const i=t.createElement("div");i.classList.add(_r("mm")),i.appendChild(Z(t,"dropdown")),n.appendChild(i),this.element.appendChild(n);const r=t.createElement("div");r.classList.add(_r("w")),this.element.appendChild(r),this.textsElem_=r,this.textViews_=e.textViews,this.applyTextViews_(),w(e.colorMode,(t=>{this.modeElem_.value=t}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){et(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach((e=>{const n=t.createElement("div");n.classList.add(_r("c")),n.appendChild(e.element),this.textsElem_.appendChild(n)}))}}function yr(t){return dn("float"===t?2:0)}function xr(t,e,n){const i=bi(t,e)[n];return new be({min:0,max:i})}function Cr(t,e,n){return new On(t,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:Ei(!1),parser:e.parser,props:A.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:yr(e.colorType)}),value:L(0,{constraint:xr(e.colorMode,e.colorType,n)}),viewProps:e.viewProps})}class Pr{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=L(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new wr(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},n=[Cr(t,e,0),Cr(t,e,1),Cr(t,e,2)];return n.forEach(((t,e)=>{xn({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[e],backward:(t,n)=>{const i=this.colorMode.rawValue,r=t.rawValue.getComponents(i,this.colorType_);return r[e]=n.rawValue,new yi(vi(di(r),r[3]),i,this.colorType_)}})})),n}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const kr=f("hpl");class Er{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(kr()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("div");n.classList.add(kr("c")),this.element.appendChild(n);const i=t.createElement("div");i.classList.add(kr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=ir(new yi([e,100,100],"hsv"));const n=Ln(e,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class Vr{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Er(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Ln(In(t.point.x,0,t.bounds.width),0,t.bounds.width,0,359),i=this.value.rawValue,[,r,s,o]=i.getComponents("hsv");this.value.setRawValue(new yi([n,r,s,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Cn(Ei(!1),kn(t));if(0===e)return;const n=this.value.rawValue,[i,r,s,o]=n.getComponents("hsv");this.value.setRawValue(new yi([i+e,r,s,o],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Cn(Ei(!1),kn(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Sr=f("svp"),Mr=64;class Lr{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Sr()),e.viewProps.bindTabIndex(this.element);const n=t.createElement("canvas");n.height=Mr,n.width=Mr,n.classList.add(Sr("c")),this.element.appendChild(n),this.canvasElement=n;const i=t.createElement("div");i.classList.add(Sr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=X(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,i=this.canvasElement.height,r=t.getImageData(0,0,n,i),s=r.data;for(let l=0;l<i;l++)for(let t=0;t<n;t++){const r=Ln(t,0,n,0,100),o=Ln(l,0,i,100,0),a=hi(e[0],r,o),c=4*(l*n+t);s[c]=a[0],s[c+1]=a[1],s[c+2]=a[2],s[c+3]=255}t.putImageData(r,0,0);const o=Ln(e[1],0,100,0,100);this.markerElem_.style.left=`${o}%`;const a=Ln(e[2],0,100,100,0);this.markerElem_.style.top=`${a}%`}onValueChange_(){this.update_()}}class Ar{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Lr(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mn(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=Ln(t.point.x,0,t.bounds.width,0,100),i=Ln(t.point.y,0,t.bounds.height,100,0),[r,,,s]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new yi([r,n,i,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Vn(t.key)&&t.preventDefault();const[e,n,i,r]=this.value.rawValue.getComponents("hsv"),s=Ei(!1),o=Cn(s,kn(t)),a=Cn(s,Pn(t));0===o&&0===a||this.value.setRawValue(new yi([e,n+o,i+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Ei(!1),n=Cn(e,kn(t)),i=Cn(e,Pn(t));0===n&&0===i||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ir{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Vr(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Ar(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new fr(t,{value:this.value,viewProps:this.viewProps}),text:new On(t,{parser:hn,baseStep:.1,props:A.fromObject({draggingScale:.01,formatter:dn(2)}),value:L(0,{constraint:new be({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&xn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const n=t.rawValue.getComponents();return n[3]=e.rawValue,new yi(n,t.rawValue.mode)}}),this.textC_=new Pr(t,{colorType:e.colorType,parser:hn,value:this.value,viewProps:this.viewProps}),this.view=new Ci(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view})}get textController(){return this.textC_}}const Dr=f("colsw");class jr{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Dr()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("div");n.classList.add(Dr("sw")),this.element.appendChild(n),this.swatchElem_=n;const i=t.createElement("button");i.classList.add(Dr("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=nr(t)}onValueChange_(){this.update_()}}class Tr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new jr(t,{value:this.value,viewProps:this.viewProps})}}class Or{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=pt.create(e.expanded),this.swatchC_=new Tr(t,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new Ee(t,{parser:e.parser,props:A.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new oi(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new Ce(t,{viewProps:this.viewProps}):null;const i=new Ir(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),xn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),vt(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=l(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=it(t);n&&e.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!W(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function Rr(t,e){return yi.isColorObject(t)?yi.fromObject(t,e):yi.black(e)}function Nr(t){return di(t.getComponents("rgb")).reduce(((t,e)=>t<<8|255&Math.floor(e)),0)}function Ur(t){return t.getComponents("rgb").reduce(((t,e,n)=>t<<8|255&Math.floor(3===n?255*e:e)),0)>>>0}function Kr(t){return new yi([t>>16&255,t>>8&255,255&t],"rgb")}function Br(t){return new yi([t>>24&255,t>>16&255,t>>8&255,Ln(255&t,0,255,0,1)],"rgb")}function Fr(t){return"number"!=typeof t?yi.black():Kr(t)}function zr(t){return"number"!=typeof t?yi.black():Br(t)}function Hr(t){const e=vr(t);return e?(t,n)=>{zn(t,e(n))}:null}function qr(t){const e=t?Ur:Nr;return(t,n)=>{zn(t,e(n))}}function $r(t,e,n){const i=e.toRgbaObject(n);t.writeProperty("r",i.r),t.writeProperty("g",i.g),t.writeProperty("b",i.b),t.writeProperty("a",i.a)}function Wr(t,e,n){const i=e.toRgbaObject(n);t.writeProperty("r",i.r),t.writeProperty("g",i.g),t.writeProperty("b",i.b)}function Gr(t,e){return(n,i)=>{t?$r(n,i,e):Wr(n,i,e)}}function Yr(t){var e;return!(!(null==t?void 0:t.alpha)&&!(null===(e=null==t?void 0:t.color)||void 0===e?void 0:e.alpha))}function Xr(t){return t?t=>nr(t,"0x"):t=>er(t,"0x")}function Qr(t){return"color"in t||"view"in t&&"color"===t.view}const Zr={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!Qr(e))return null;const n=ki(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>Yr(t.params)?zr:Fr,equals:yi.equals,writer:t=>qr(Yr(t.params))},controller:t=>{const e=Yr(t.params),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new Or(t.document,{colorType:"int",expanded:null!=n&&n,formatter:Xr(e),parser:Ji("int"),pickerLayout:null!=i?i:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function Jr(t){return yi.isRgbaColorObject(t)}function ts(t){return e=>Rr(e,t)}function es(t,e){return n=>t?pr(n,e):cr(n,e)}const ns={id:"input-color-object",type:"input",accept:(t,e)=>{if(!yi.isColorObject(t))return null;const n=ki(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>ts(Vi(t.params)),equals:yi.equals,writer:t=>Gr(Jr(t.initialValue),Vi(t.params))},controller:t=>{var e;const n=yi.isRgbaColorObject(t.initialValue),i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0,s=null!==(e=Vi(t.params))&&void 0!==e?e:"int";return new Or(t.document,{colorType:s,expanded:null!=i&&i,formatter:es(n,s),parser:Ji(s),pickerLayout:null!=r?r:"popup",supportsAlpha:n,value:t.value,viewProps:t.viewProps})}},is={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;const n=Xi(t,Vi(e));if(!n)return null;if(!vr(n))return null;const i=ki(e);return i?{initialValue:t,params:i}:null},binding:{reader:t=>{var e;return Zi(null!==(e=Vi(t.params))&&void 0!==e?e:"int")},equals:yi.equals,writer:t=>{const e=Xi(t.initialValue,Vi(t.params));if(!e)throw u.shouldNeverHappen();const n=Hr(e);if(!n)throw u.notBindable();return n}},controller:t=>{const e=Xi(t.initialValue,Vi(t.params));if(!e)throw u.shouldNeverHappen();const n=vr(e);if(!n)throw u.shouldNeverHappen();const i="expanded"in t.params?t.params.expanded:void 0,r="picker"in t.params?t.params.picker:void 0;return new Or(t.document,{colorType:e.type,expanded:null!=i&&i,formatter:n,parser:Ji(e.type),pickerLayout:null!=r?r:"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}};class rs{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map(((t,e)=>{var n,i;return null!==(i=null===(n=this.components[e])||void 0===n?void 0:n.constrain(t))&&void 0!==i?i:t}));return this.asm_.fromComponents(e)}}const ss=f("pndtxt");class os{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(ss()),this.textViews.forEach((e=>{const n=t.createElement("div");n.classList.add(ss("a")),n.appendChild(e.element),this.element.appendChild(n)}))}}function as(t,e,n){return new On(t,{arrayPosition:0===n?"fst":n===e.axes.length-1?"lst":"mid",baseStep:e.axes[n].baseStep,parser:e.parser,props:e.axes[n].textProps,value:L(0,{constraint:e.axes[n].constraint}),viewProps:e.viewProps})}class ls{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map(((n,i)=>as(t,e,i))),this.acs_.forEach(((t,n)=>{xn({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[n],backward:(t,i)=>{const r=e.assembly.toComponents(t.rawValue);return r[n]=i.rawValue,e.assembly.fromComponents(r)}})})),this.view=new os(t,{textViews:this.acs_.map((t=>t.view))})}}function cs(t,e){return"step"in t&&!c(t.step)?new fe(t.step,e):null}function hs(t){return"max"in t&&!c(t.max)||"min"in t&&!c(t.min)?new be({max:t.max,min:t.min}):null}function ps(t,e){const n=[],i=cs(t,e);i&&n.push(i);const r=hs(t);r&&n.push(r);const s=Gn(t.options);return s&&n.push(s),new de(n)}function us(t){const e=t?ve(t,be):null;return e?[e.minValue,e.maxValue]:[void 0,void 0]}function ds(t){const[e,n]=us(t);return[null!=e?e:0,null!=n?n:100]}const vs={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const n=R,i=N(e,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(Hn),step:n.optional.number});return i?{initialValue:t,params:i}:null},binding:{reader:t=>pn,constraint:t=>ps(t.params,t.initialValue),writer:t=>zn},controller:t=>{var e,n;const i=t.value,r=t.constraint;if(r&&ve(r,me))return new we(t.document,{props:A.fromObject({options:null!==(e=Yn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps});const s=null!==(n="format"in t.params?t.params.format:void 0)&&void 0!==n?n:dn(Qn(r,i.rawValue));if(r&&ve(r,be)){const[e,n]=ds(r);return new Fn(t.document,{baseStep:Zn(r),parser:hn,sliderProps:A.fromObject({maxValue:n,minValue:e}),textProps:A.fromObject({draggingScale:Jn(r,i.rawValue),formatter:s}),value:i,viewProps:t.viewProps})}return new On(t.document,{baseStep:Zn(r),parser:hn,props:A.fromObject({draggingScale:Jn(r,i.rawValue),formatter:s}),value:i,viewProps:t.viewProps})}};class ms{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(c(t))return!1;const e=t.x,n=t.y;return"number"==typeof e&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const bs={toComponents:t=>t.getComponents(),fromComponents:t=>new ms(...t)},fs=f("p2d");class _s{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(fs()),e.viewProps.bindClassModifiers(this.element),w(e.expanded,C(this.element,fs(void 0,"expanded")));const n=t.createElement("div");n.classList.add(fs("h")),this.element.appendChild(n);const i=t.createElement("button");i.classList.add(fs("b")),i.appendChild(Z(t,"p2dpad")),e.viewProps.bindDisabled(i),n.appendChild(i),this.buttonElement=i;const r=t.createElement("div");if(r.classList.add(fs("t")),n.appendChild(r),this.textElement=r,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(fs("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const gs=f("p2dp");class ws{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(gs()),"popup"===e.layout&&this.element.classList.add(gs(void 0,"p"));const n=t.createElement("div");n.classList.add(gs("p")),e.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const i=t.createElementNS(H,"svg");i.classList.add(gs("g")),this.padElement.appendChild(i),this.svgElem_=i;const r=t.createElementNS(H,"line");r.classList.add(gs("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const s=t.createElementNS(H,"line");s.classList.add(gs("ax")),s.setAttributeNS(null,"x1","50%"),s.setAttributeNS(null,"y1","0"),s.setAttributeNS(null,"x2","50%"),s.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(s);const o=t.createElementNS(H,"line");o.classList.add(gs("l")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(o),this.lineElem_=o;const a=t.createElement("div");a.classList.add(gs("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),n=this.maxValue_,i=Ln(t,-n,+n,0,100),r=Ln(e,-n,+n,0,100),s=this.invertsY_?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${s}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${s}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ys(t,e,n){return[Cn(e[0],kn(t)),Cn(e[1],Pn(t))*(n?1:-1)]}class xs{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new ws(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mn(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const n=this.maxValue_,i=Ln(t.point.x,0,t.bounds.width,-n,+n),r=Ln(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-n,+n);this.value.setRawValue(new ms(i,r),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Vn(t.key)&&t.preventDefault();const[e,n]=ys(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(new ms(this.value.rawValue.x+e,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,n]=ys(t,this.baseSteps_,this.invertsY_);0===e&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Cs{constructor(t,e){var n,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=pt.create(e.expanded),this.popC_="popup"===e.pickerLayout?new Ce(t,{viewProps:this.viewProps}):null;const r=new xs(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.textC_=new ls(t,{assembly:bs,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new _s(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(i=this.view.buttonElement)||void 0===i||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),xn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),vt(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,n=l(t.relatedTarget);n&&e.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,n=it(t);n&&e.contains(n)||n&&n===this.view.buttonElement&&!W(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}function Ps(t){return ms.isObject(t)?new ms(t.x,t.y):new ms}function ks(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}function Es(t,e){if(!t)return;const n=[],i=cs(t,e);i&&n.push(i);const r=hs(t);return r&&n.push(r),new de(n)}function Vs(t,e){return new rs({assembly:bs,components:[Es("x"in t?t.x:void 0,e.x),Es("y"in t?t.y:void 0,e.y)]})}function Ss(t,e){var n,i;const r=t&&ve(t,be);if(r)return Math.max(Math.abs(null!==(n=r.minValue)&&void 0!==n?n:0),Math.abs(null!==(i=r.maxValue)&&void 0!==i?i:0));const s=Zn(t);return Math.max(10*Math.abs(s),10*Math.abs(e))}function Ms(t,e){const n=e instanceof rs?e.components[0]:void 0,i=e instanceof rs?e.components[1]:void 0,r=Ss(n,t.x),s=Ss(i,t.y);return Math.max(r,s)}function Ls(t,e){return{baseStep:Zn(e),constraint:e,textProps:A.fromObject({draggingScale:Jn(e,t),formatter:dn(Qn(e,t))})}}function As(t){if(!("y"in t))return!1;const e=t.y;return!!e&&"inverted"in e&&!!e.inverted}const Is={id:"input-point2d",type:"input",accept:(t,e)=>{if(!ms.isObject(t))return null;const n=R,i=N(e,{expanded:n.optional.boolean,picker:n.optional.custom(qn),x:n.optional.custom($n),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Ps,constraint:t=>Vs(t.params,t.initialValue),equals:ms.equals,writer:t=>ks},controller:t=>{const e=t.document,n=t.value,i=t.constraint;if(!(i instanceof rs))throw u.shouldNeverHappen();const r="expanded"in t.params?t.params.expanded:void 0,s="picker"in t.params?t.params.picker:void 0;return new Cs(e,{axes:[Ls(n.rawValue.x,i.components[0]),Ls(n.rawValue.y,i.components[1])],expanded:null!=r&&r,invertsY:As(t.params),maxValue:Ms(n.rawValue,i),parser:hn,pickerLayout:null!=s?s:"popup",value:n,viewProps:t.viewProps})}};class Ds{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(c(t))return!1;const e=t.x,n=t.y,i=t.z;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const js={toComponents:t=>t.getComponents(),fromComponents:t=>new Ds(...t)};function Ts(t){return Ds.isObject(t)?new Ds(t.x,t.y,t.z):new Ds}function Os(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}function Rs(t,e){return new rs({assembly:js,components:[Es("x"in t?t.x:void 0,e.x),Es("y"in t?t.y:void 0,e.y),Es("z"in t?t.z:void 0,e.z)]})}function Ns(t,e){return{baseStep:Zn(e),constraint:e,textProps:A.fromObject({draggingScale:Jn(e,t),formatter:dn(Qn(e,t))})}}const Us={id:"input-point3d",type:"input",accept:(t,e)=>{if(!Ds.isObject(t))return null;const n=R,i=N(e,{x:n.optional.custom($n),y:n.optional.custom($n),z:n.optional.custom($n)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Ts,constraint:t=>Rs(t.params,t.initialValue),equals:Ds.equals,writer:t=>Os},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof rs))throw u.shouldNeverHappen();return new ls(t.document,{assembly:js,axes:[Ns(e.rawValue.x,n.components[0]),Ns(e.rawValue.y,n.components[1]),Ns(e.rawValue.z,n.components[2])],parser:hn,value:e,viewProps:t.viewProps})}};class Ks{constructor(t=0,e=0,n=0,i=0){this.x=t,this.y=e,this.z=n,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(c(t))return!1;const e=t.x,n=t.y,i=t.z,r=t.w;return"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof r}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Bs={toComponents:t=>t.getComponents(),fromComponents:t=>new Ks(...t)};function Fs(t){return Ks.isObject(t)?new Ks(t.x,t.y,t.z,t.w):new Ks}function zs(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}function Hs(t,e){return new rs({assembly:Bs,components:[Es("x"in t?t.x:void 0,e.x),Es("y"in t?t.y:void 0,e.y),Es("z"in t?t.z:void 0,e.z),Es("w"in t?t.w:void 0,e.w)]})}function qs(t,e){return{baseStep:Zn(e),constraint:e,textProps:A.fromObject({draggingScale:Jn(e,t),formatter:dn(Qn(e,t))})}}const $s={id:"input-point4d",type:"input",accept:(t,e)=>{if(!Ks.isObject(t))return null;const n=R,i=N(e,{x:n.optional.custom($n),y:n.optional.custom($n),z:n.optional.custom($n),w:n.optional.custom($n)});return i?{initialValue:t,params:i}:null},binding:{reader:t=>Fs,constraint:t=>Hs(t.params,t.initialValue),equals:Ks.equals,writer:t=>zs},controller:t=>{const e=t.value,n=t.constraint;if(!(n instanceof rs))throw u.shouldNeverHappen();return new ls(t.document,{assembly:Bs,axes:e.rawValue.getComponents().map(((t,e)=>qs(t,n.components[e]))),parser:hn,value:e,viewProps:t.viewProps})}};function Ws(t){const e=[],n=Gn(t.options);return n&&e.push(n),new de(e)}const Gs={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const n=N(e,{options:R.optional.custom(Hn)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>bn,constraint:t=>Ws(t.params),writer:t=>zn},controller:t=>{var e;const n=t.document,i=t.value,r=t.constraint;return r&&ve(r,me)?new we(n,{props:A.fromObject({options:null!==(e=Yn(r))&&void 0!==e?e:[]}),value:i,viewProps:t.viewProps}):new Ee(n,{parser:t=>t,props:A.fromObject({formatter:fn}),value:i,viewProps:t.viewProps})}},Ys={monitor:{defaultInterval:200,defaultLineCount:3}},Xs=f("mll");class Qs{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Xs()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("textarea");n.classList.add(Xs("i")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,n.readOnly=!0,e.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,n=[];this.value.rawValue.forEach((t=>{void 0!==t&&n.push(this.formatter_(t))})),t.textContent=n.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class Zs{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Qs(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const Js=f("sgl");class to{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Js()),e.viewProps.bindClassModifiers(this.element);const n=t.createElement("input");n.classList.add(Js("i")),n.readOnly=!0,n.type="text",e.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class eo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new to(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const no={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const n=N(e,{lineCount:R.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Se},controller:t=>{var e;return 1===t.value.rawValue.length?new eo(t.document,{formatter:Me,value:t.value,viewProps:t.viewProps}):new Zs(t.document,{formatter:Me,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Ys.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}},io=f("grl");class ro{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(io()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=t.createElementNS(H,"svg");n.classList.add(io("g")),n.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const i=t.createElementNS(H,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const r=t.createElement("div");r.classList.add(io("t"),f("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,n=this.props_.get("minValue"),i=this.props_.get("maxValue"),r=[];this.value.rawValue.forEach(((s,o)=>{if(void 0===s)return;const a=Ln(o,0,e,0,t.width),l=Ln(s,n,i,t.height,0);r.push([a,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const s=this.tooltipElem_,o=this.value.rawValue[this.cursor_.rawValue];if(void 0===o)return void s.classList.remove(io("t","a"));const a=Ln(this.cursor_.rawValue,0,e,0,t.width),l=Ln(o,n,i,t.height,0);s.style.left=`${a}px`,s.style.top=`${l}px`,s.textContent=`${this.formatter_(o)}`,s.classList.contains(io("t","a"))||(s.classList.add(io("t","a"),io("t","in")),q(s),s.classList.remove(io("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class so{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=L(-1),this.view=new ro(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),W(t)){const t=new Mn(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Ln(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(Ln(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function oo(t){return"format"in t&&!c(t.format)?t.format:dn(2)}function ao(t){var e;return 1===t.value.rawValue.length?new eo(t.document,{formatter:oo(t.params),value:t.value,viewProps:t.viewProps}):new Zs(t.document,{formatter:oo(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Ys.monitor.defaultLineCount,value:t.value,viewProps:t.viewProps})}function lo(t){var e,n,i;return new so(t.document,{formatter:oo(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Ys.monitor.defaultLineCount,props:A.fromObject({maxValue:null!==(n="max"in t.params?t.params.max:null)&&void 0!==n?n:100,minValue:null!==(i="min"in t.params?t.params.min:null)&&void 0!==i?i:0}),value:t.value,viewProps:t.viewProps})}function co(t){return"view"in t&&"graph"===t.view}const ho={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const n=R,i=N(e,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return i?{initialValue:t,params:i}:null},binding:{defaultBufferSize:t=>co(t)?64:1,reader:t=>pn},controller:t=>co(t.params)?lo(t):ao(t)},po={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const n=R,i=N(e,{lineCount:n.optional.number,multiline:n.optional.boolean});return i?{initialValue:t,params:i}:null},binding:{reader:t=>bn},controller:t=>{var e;const n=t.value;return n.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new Zs(t.document,{formatter:fn,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:Ys.monitor.defaultLineCount,value:n,viewProps:t.viewProps}):new eo(t.document,{formatter:fn,value:n,viewProps:t.viewProps})}};class uo{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new m,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function vo(t,e){const n=t.accept(e.target.read(),e.params);if(c(n))return null;const i=R,r={target:e.target,initialValue:n.initialValue,params:n.params},s=t.binding.reader(r),o=t.binding.constraint?t.binding.constraint(r):void 0,a=L(s(n.initialValue),{constraint:o,equals:t.binding.equals}),l=new uo({reader:s,target:e.target,value:a,writer:t.binding.writer(r)}),h=i.optional.boolean(e.params.disabled).value,p=i.optional.boolean(e.params.hidden).value,u=t.controller({constraint:o,document:e.document,initialValue:n.initialValue,params:n.params,value:l.value,viewProps:Qt.create({disabled:h,hidden:p})}),d=i.optional.string(e.params.label).value;return new xt(e.document,{binding:l,blade:ht(),props:A.fromObject({label:null!=d?d:e.target.key}),valueController:u})}class mo{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new m,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,n=this.reader_(t);this.value.rawValue=yn(e,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(t){this.read()}}function bo(t,e){return 0===e?new pe:new ue(t,null!=e?e:Ys.monitor.defaultInterval)}function fo(t,e){var n,i,r;const s=R,o=t.accept(e.target.read(),e.params);if(c(o))return null;const a={target:e.target,initialValue:o.initialValue,params:o.params},l=t.binding.reader(a),h=null!==(i=null!==(n=s.optional.number(e.params.bufferSize).value)&&void 0!==n?n:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(o.params))&&void 0!==i?i:1,p=s.optional.number(e.params.interval).value,u=new mo({reader:l,target:e.target,ticker:bo(e.document,p),value:gn(h)}),d=s.optional.boolean(e.params.disabled).value,v=s.optional.boolean(e.params.hidden).value,m=t.controller({document:e.document,params:o.params,value:u.value,viewProps:Qt.create({disabled:d,hidden:v})}),b=null!==(r=s.optional.string(e.params.label).value)&&void 0!==r?r:e.target.key;return new Pt(e.document,{binding:u,blade:ht(),props:A.fromObject({label:b}),valueController:m})}class _o{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,n){if(c(e.read()))throw new u({context:{key:e.key},type:"nomatchingcontroller"});const i=this.pluginsMap_.inputs.reduce(((i,r)=>null!=i?i:vo(r,{document:t,target:e,params:n})),null);if(i)return i;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,n){const i=this.pluginsMap_.monitors.reduce(((i,r)=>null!=i?i:fo(r,{document:t,params:n,target:e})),null);if(i)return i;throw new u({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const n=this.pluginsMap_.blades.reduce(((n,i)=>null!=n?n:he(i,{document:t,params:e})),null);if(!n)throw new u({type:"nomatchingview",context:{params:e}});return n}createBladeApi(t){if(t instanceof xt)return new yt(t);if(t instanceof Pt)return new Ct(t);if(t instanceof Nt)return new St(t,this);const e=this.pluginsMap_.blades.reduce(((e,n)=>null!=e?e:n.api({controller:t,pool:this})),null);if(!e)throw u.shouldNeverHappen();return e}}function go(){const t=new _o;return[Is,Us,$s,Gs,vs,is,ns,Zr,ri,no,po,ho,lt,Ft,Gt,ce].forEach((e=>{t.register(e)})),t}class wo extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class yo extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}class xo extends n{constructor(t){super(t),this.emitter_=new m,this.controller_.valueController.value.emitter.on("change",(t=>{this.emitter_.emit("change",{event:new r(this,t.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const n=e.bind(this);return this.emitter_.on(t,(t=>{n(t.event)})),this}}const Co={id:"list",type:"blade",accept(t){const e=R,n=N(t,{options:e.required.custom(Hn),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return n?{params:n}:null},controller(t){const e=new we(t.document,{props:A.fromObject({options:Wn(t.params.options)}),value:L(t.params.value),viewProps:t.viewProps});return new zt(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:e})},api:t=>t.controller instanceof zt&&t.controller.valueController instanceof we?new wo(t.controller):null};function Po(t){return t.reduce(((t,e)=>Object.assign(t,{[e.presetKey]:e.read()})),{})}function ko(t,e){t.forEach((t=>{const n=e[t.presetKey];void 0!==n&&t.write(n)}))}class Eo extends Mt{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){ko(this.controller_.rackController.rack.find(xt).map((t=>t.binding.target)),t),this.refresh()}exportPreset(){return Po(this.controller_.rackController.rack.find(xt).map((t=>t.binding.target)))}refresh(){this.controller_.rackController.rack.find(xt).forEach((t=>{t.binding.read()})),this.controller_.rackController.rack.find(Pt).forEach((t=>{t.binding.read()}))}}class Vo extends Bt{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const So={id:"slider",type:"blade",accept(t){const e=R,n=N(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return n?{params:n}:null},controller(t){var e,n;const i=null!==(e=t.params.value)&&void 0!==e?e:0,r=new Fn(t.document,{baseStep:1,parser:hn,sliderProps:A.fromObject({maxValue:t.params.max,minValue:t.params.min}),textProps:A.fromObject({draggingScale:Jn(void 0,i),formatter:null!==(n=t.params.format)&&void 0!==n?n:un}),value:L(i),viewProps:t.viewProps});return new zt(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:r})},api:t=>t.controller instanceof zt&&t.controller.valueController instanceof Fn?new yo(t.controller):null},Mo={id:"text",type:"blade",accept(t){const e=R,n=N(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return n?{params:n}:null},controller(t){var e;const n=new Ee(t.document,{parser:t.params.parse,props:A.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:L(t.params.value),viewProps:t.viewProps});return new zt(t.document,{blade:t.blade,props:A.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof zt&&t.controller.valueController instanceof Ee?new xo(t.controller):null};function Lo(t){const e=t.createElement("div");return e.classList.add(f("dfw")()),t.body&&t.body.appendChild(e),e}function Ao(t,e,n){if(t.querySelector(`style[data-tp-style=${e}]`))return;const i=t.createElement("style");i.dataset.tpStyle=e,i.textContent=n,t.head.appendChild(i)}class Io extends Eo{constructor(t){var e,n;const i=null!=t?t:{},r=null!==(e=i.document)&&void 0!==e?e:Y(),s=go();super(new Vo(r,{expanded:i.expanded,blade:ht(),props:A.fromObject({title:i.title}),viewProps:Qt.create()}),s),this.pool_=s,this.containerElem_=null!==(n=i.container)&&void 0!==n?n:Lo(r),this.containerElem_.appendChild(this.element),this.doc_=r,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw u.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw u.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach((t=>{this.pool_.register(t),this.embedPluginStyle_(t)}))}embedPluginStyle_(t){t.css&&Ao(this.document,`plugin-${t.id}`,t.css)}setUpDefaultPlugins_(){Ao(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor transparent;scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:transparent}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:transparent solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, #28292e);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, #adafb8);--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, #28292e);--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, #bbbcc4);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, #bbbcc4);--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_i,.tp-fldv_c>.tp-tabv>.tp-tabv_i{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a:before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_c{border-left:var(--cnt-bg) solid 4px}.tp-fldv_b:hover+.tp-fldv_c{border-left-color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_c{border-left-color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_c{border-left-color:var(--cnt-bg-a)}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv.tp-v-disabled{opacity:.5}.tp-tabv_i{align-items:flex-end;display:flex;overflow:hidden}.tp-tabv.tp-tabv-nop .tp-tabv_i{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_i::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{border-left:var(--cnt-bg) solid 4px;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p)}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:-2px;position:absolute;width:2px}.tp-tbiv_b{background-color:var(--cnt-bg);display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);width:100%}.tp-tbiv_b:hover{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active{background-color:var(--cnt-bg-a)}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) transparent transparent transparent;border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c,.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_i{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((t=>{this.embedPluginStyle_(t)})),this.registerPlugin({plugins:[So,Co,ce,Mo]})}}const Do=new e("3.1.0");t.BladeApi=n,t.ButtonApi=v,t.FolderApi=Mt,t.InputBindingApi=yt,t.ListApi=wo,t.MonitorBindingApi=Ct,t.Pane=Io,t.SeparatorApi=Ht,t.SliderApi=yo,t.TabApi=ie,t.TabPageApi=ne,t.TextApi=xo,t.TpChangeEvent=r,t.VERSION=Do,Object.defineProperty(t,"__esModule",{value:!0})}(ge.exports);const we=window.location.search;let ye,xe;new URLSearchParams(we).get("debug")&&(xe=new ge.exports.Pane({title:"Settings",expanded:false}));const Ce=()=>{document.body.style.width=`${document.documentElement.clientWidth}px`,document.body.style.height=`${document.documentElement.clientHeight}px`,ye&&ye.resize()};var Pe,ke,Ee;de(window,"resize").pipe((Pe=100,void 0===ke&&(ke=Rt),Mt((function(t,e){var n=null,i=null,r=null,s=function(){if(n){n.unsubscribe(),n=null;var t=i;i=null,e.next(t)}};function o(){var t=r+Pe,i=ke.now();if(i<t)return n=this.schedule(void 0,t-i),void e.add(n);s()}t.subscribe(Lt(e,(function(t){i=t,r=ke.now(),n||(n=ke.schedule(o,Pe),e.add(n))}),(function(){s(),e.complete()}),void 0,(function(){i=n=null})))})))).subscribe((()=>Ce())),de(window,"load").pipe((Ee=1,Ee<=0?function(){return Nt}:Mt((function(t,e){var n=0;t.subscribe(Lt(e,(function(t){++n<=Ee&&(e.next(t),Ee<=n&&e.complete())})))})))).subscribe((()=>Ce()));const Ve=document.querySelector("canvas");ye=new class{constructor(t,e=null,n=!1,i=null){q(this,M),q(this,A),q(this,D),q(this,T),q(this,R),q(this,U),F(this,"TARGET_FRAME_DURATION",16),q(this,k,0),q(this,E,0),q(this,V,0),q(this,S,0),F(this,"viewportSize",new me),F(this,"simulation",new _e),this.canvas=t,this.onInit=e,this.pane=i,this.isDev=n,W(this,M,L).call(this)}run(t=0){$(this,E,Math.min(32,t-H(this,k))),$(this,k,t),$(this,S,H(this,E)/this.TARGET_FRAME_DURATION),$(this,V,H(this,V)+H(this,S)),W(this,R,N).call(this,H(this,E)),W(this,U,K).call(this),requestAnimationFrame((t=>this.run(t)))}resize(){this.viewportSize.set(this.canvas.clientWidth,this.canvas.clientHeight),function(t){const e=Math.min(1,window.devicePixelRatio),n=Math.round(t.clientWidth*e),i=Math.round(t.clientHeight*e),r=t.width!==n||t.height!==i;r&&(t.width=n,t.height=i)}(this.canvas)}}(Ve,(t=>t.run()),false,xe),Ce();
